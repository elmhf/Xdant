# WebSocket Implementation

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅูุดุงุก ูุธุงู WebSocket ุดุงูู ูุฅุฏุงุฑุฉ ุงูุงุชุตุงูุงุช ูู ุงูููุช ุงููุนูู ุจูู ุงููุณุชุฎุฏููู ูุงูุนูุงุฏุฉ.

## ๐๏ธ ุงููููุงุช

### 1. `useWebSocket.js`
Hook ุฃุณุงุณู ูุฅุฏุงุฑุฉ ุงุชุตุงู WebSocket ูุน ุงูุฎุงุฏู.

**ุงูููุฒุงุช:**
- โ ุงุชุตุงู ุชููุงุฆู ูุน ุฅุนุงุฏุฉ ุงูุงุชุตุงู
- โ ุฅุฏุงุฑุฉ ุญุงูุฉ ุงูุงุชุตุงู
- โ ุงุณุชูุจุงู ุงูุฅุดุนุงุฑุงุช ูู ุงูููุช ุงููุนูู
- โ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุนูุงุฏุงุช

**ุงูุงุณุชุฎุฏุงู:**
```javascript
import { useWebSocket } from '../hooks/useWebSocket';

const { 
  isConnected, 
  connectionStatus, 
  notifications,
  selectPatient,
  clearNotifications 
} = useWebSocket(userId, clinicId);
```

### 2. `usePatientWebSocket.js`
Hook ูุฎุตุต ูุตูุญุฉ ุงููุฑูุถ ูุน ุฅุฏุงุฑุฉ ุงูุชูุงุฑูุฑ.

**ุงูููุฒุงุช:**
- โ ูุฑุงูุจุฉ ุชูุงุฑูุฑ ุงููุฑูุถ ุงููุญุฏุฏ
- โ ุชุญุฏูุซ ุญุงูุฉ ุงูุชูุงุฑูุฑ ุชููุงุฆูุงู
- โ ุฅุถุงูุฉ ุชูุงุฑูุฑ ุฌุฏูุฏุฉ
- โ ุฅุญุตุงุฆูุงุช ุงูุชูุงุฑูุฑ

**ุงูุงุณุชุฎุฏุงู:**
```javascript
import { usePatientWebSocket } from '../hooks/usePatientWebSocket';

const {
  isConnected,
  patientReports,
  lastUpdate,
  updateReport,
  addReport,
  deleteReport
} = usePatientWebSocket(patientId, userId, clinicId);
```

### 3. `websocket-server.js`
ุฎุงุฏู WebSocket ูุน ุฅุฏุงุฑุฉ ุงูุนูุงุฏุงุช ูุงููุณุชุฎุฏููู.

**ุงูููุฒุงุช:**
- โ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ุงููุชุตููู
- โ ุฅุฏุงุฑุฉ ุงูุนูุงุฏุงุช
- โ ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูู ุงูููุช ุงููุนูู
- โ ูุญุงูุงุฉ ุงูุฃุญุฏุงุซ ููุชุฌุฑุจุฉ

## ๐ก ุงูุฃุญุฏุงุซ ุงููุฏุนููุฉ

### ูู ุงูุนููู ุฅูู ุงูุฎุงุฏู:
- `user_login` - ุฏุฎูู ุงููุณุชุฎุฏู ููุนูุงุฏุฉ
- `select_patient` - ุงุฎุชูุงุฑ ูุฑูุถ ูุนูู

### ูู ุงูุฎุงุฏู ุฅูู ุงูุนููู:
- `login_success` - ูุฌุงุญ ุฏุฎูู ุงูุนูุงุฏุฉ
- `login_error` - ุฎุทุฃ ูู ุฏุฎูู ุงูุนูุงุฏุฉ
- `report_status_changed_realtime` - ุชุบููุฑ ุญุงูุฉ ุงูุชูุฑูุฑ
- `report_created_realtime` - ุฅูุดุงุก ุชูุฑูุฑ ุฌุฏูุฏ
- `user_joined_clinic` - ุงูุถูุงู ูุณุชุฎุฏู ููุนูุงุฏุฉ
- `user_left_clinic` - ูุบุงุฏุฑุฉ ูุณุชุฎุฏู ููุนูุงุฏุฉ

## ๐ ุชุดุบูู ุงูุฎุงุฏู

```bash
# ุชุซุจูุช ุงูููุชุจุงุช
npm install express socket.io cors nodemon

# ุชุดุบูู ุงูุฎุงุฏู
node websocket-server.js

# ุฃู ููุชุทููุฑ
nodemon websocket-server.js
```

## ๐ ุฅุญุตุงุฆูุงุช ุงูุฎุงุฏู

ุงูุฎุงุฏู ูุนุฑุถ ุฅุญุตุงุฆูุงุช ูู 30 ุซุงููุฉ:
- ุนุฏุฏ ุงููุณุชุฎุฏููู ุงููุชุตููู
- ุนุฏุฏ ุงูุนูุงุฏุงุช ุงููุดุทุฉ
- ุนุฏุฏ ุงููุณุชุฎุฏููู ูู ูู ุนูุงุฏุฉ

## ๐ง ุงูุชุฎุตูุต

### ุชุบููุฑ ูููุฐ ุงูุฎุงุฏู:
```javascript
const PORT = 5000; // ุชุบููุฑ ุงูุฑูู ุญุณุจ ุงูุญุงุฌุฉ
```

### ุชุบููุฑ ุนููุงู ุงูุฎุงุฏู ูู ุงูุนููู:
```javascript
socketRef.current = io('https://serverrouter.onrender.com', {
  // ุงูุฎูุงุฑุงุช
});
```

### ุฅุถุงูุฉ ุฃุญุฏุงุซ ุฌุฏูุฏุฉ:
```javascript
// ูู ุงูุฎุงุฏู
socket.on('custom_event', (data) => {
  // ูุนุงูุฌุฉ ุงูุญุฏุซ
});

// ูู ุงูุนููู
socket.emit('custom_event', data);
```

## ๐ก๏ธ ุงูุฃูุงู

- โ CORS ูููุนูู ููุนูุงููู ุงููุณููุญุฉ
- โ Credentials ูููุนูู ููุฌูุณุงุช
- โ ุฅุนุงุฏุฉ ุงูุงุชุตุงู ุงูุชููุงุฆู
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

## ๐ฑ ุงูุงุณุชุฎุฏุงู ูู ุงูุชุทุจูู

### ูู ุตูุญุฉ ุงููุฑูุถ:
```javascript
import { usePatientWebSocket } from '../hooks/usePatientWebSocket';

export default function PatientPage() {
  const {
    isConnected,
    patientReports,
    lastUpdate
  } = usePatientWebSocket(patientId, userId, clinicId);

  return (
    <div>
      {isConnected && (
        <div className="connection-status">
          โ ูุชุตู ุจุงูุฎุงุฏู
        </div>
      )}
      
      {lastUpdate && (
        <div className="last-update">
          ุขุฎุฑ ุชุญุฏูุซ: {lastUpdate.timestamp}
        </div>
      )}
      
      {/* ุนุฑุถ ุงูุชูุงุฑูุฑ */}
    </div>
  );
}
```

## ๐ฏ ุงูููุฒุงุช ุงููุณุชูุจููุฉ

- [ ] ุฅุดุนุงุฑุงุช ุตูุชูุฉ
- [ ] ูุคุดุฑุงุช ุญุงูุฉ ุงูุงุชุตุงู ูู ุงููุงุฌูุฉ
- [ ] ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช ุงููุชูุฏูุฉ
- [ ] ุชุดููุฑ ุงูุฑุณุงุฆู
- [ ] ุฏุนู ุงูุบุฑู ุงููุชุนุฏุฏุฉ 